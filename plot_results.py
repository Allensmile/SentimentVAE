import numpy as np
from matplotlib import pyplot as plt
from operator import itemgetter

results = {
    'dropout':
    [(1501, (512.02972139966823, 5.3948497744508579, -825.88029423916078)), (3001, (268.23403008448059, 7.4139962600463836, -742.86737420071688)), (4501, (207.64849823753028, 9.1902045432330102, -710.97218955603978)), (6001, (183.68722279014108, 9.9888062694514783, -695.6445597163173)), (7501, (172.06235258733338, 10.131443889769562, -687.18860711152797)), (9001, (163.20878646722215, 10.410936014026614, -680.52022550023491)), (10501, (157.37802866840815, 10.550889027787232, -675.87546380952028)), (12001, (153.4835197806828, 10.250866747604407, -672.27982057804104))],
    'vae': [(1501, (69.382353821212092, 0.07669955590374955, -557.6822514727528)), (3001, (56.763169125289984, 0.05427626912573167, -531.25742983566545)), (4501, (51.314269322442165, 0.13325254101546205, -518.06334851437339)), (6001, (48.113316851716974, 0.23491822460658418, -509.693689028081)), (7501, (46.528056213184172, 0.2983122704633549, -505.35063140745689)), (9001, (45.174266608930232, 0.38724252434707285, -501.55598990315724)), (10501, (43.818157515972068, 0.48532084055954056, -497.64536289788236)), (12001, (43.113302018704715, 0.51327762033290136, -495.54046520776745)), (13501, (42.248621912870078, 0.47652887171233704, -492.83909790387588))]

}


def get_stats_at_index(result, index):
    return [item[1][index] for item in result]


def plot_stat(index, name):
    plt.figure()

    for key in results:
        steps = [item[0] for item in results[key]]
        perpl = get_stats_at_index(results[key], index)
        plt.plot(steps, perpl, label=key)

    plt.xlabel('Batches')
    plt.ylabel(name)
    plt.legend()
    plt.grid(True)

plot_stat(0, 'Perplexity')
plot_stat(2, 'Log-likelihood')
plot_stat(1, 'KL-Divergence')
plt.show()
